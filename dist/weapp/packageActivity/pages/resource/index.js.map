{"version":3,"file":"packageActivity/pages/resource/index.js","sources":["webpack:///./src/packageActivity/pages/resource/index.vue?91a7","webpack:///index.vue","webpack:///./src/packageActivity/pages/resource/index.vue?2af3","webpack:///._src_packageActivity_pages_resource_index.scss","webpack:///._src_packageActivity_pages_resource_index.vue","webpack:///./src/packageActivity/pages/resource/index.vue?80bc","webpack:///./src/packageActivity/pages/resource/index.vue?a144"],"sourcesContent":["import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=45ab1bef&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  \n}\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  \"45ab1bef\",\n  \"b036b786\"\n  \n)\n\ncomponent.options.__file = \"src/packageActivity/pages/resource/index.vue\"\nexport default component.exports","<template>\n  <view class=\"resource\">\n    <view class=\"resource-banner\">\n      <image mode=\"widthFix\" :src=\"banner\" @tap=\"goHome\"></image>\n    </view>\n    <view class=\"resource-list\">\n      <view class=\"resource-box\" v-for=\"(item, index) in list\" :key=\"index\">\n        <image\n          mode=\"scaleToFill\"\n          class=\"resource-hot\"\n          src=\"https://yuepai-oss.qubeitech.com/static/images/hot.png\"\n          v-if=\"item.is_hot\"\n        ></image>\n        <view class=\"resource-left\">\n          <image mode=\"aspectFill\" :src=\"item.cover\"></image>\n        </view>\n        <view class=\"resource-right\">\n          <view class=\"resource-title\">{{ item.title }}</view>\n          <view class=\"resource-desc\"> {{ item.subtitle }} </view>\n          <view class=\"resource-get\">\n            <text class=\"resource-get-num\"\n              >已被领取：{{ item.click_cnt }}次</text\n            >\n            <text class=\"resource-btn\" @tap=\"resourceGet(item.oid)\"\n              >我要领取</text\n            >\n          </view>\n        </view>\n      </view>\n    </view>\n    <view class=\"resource-modal\" v-if=\"visible\" @tap=\"close\">\n      <view class=\"resource-content\">\n        <view class=\"resource-content-title\"> 获取资料 </view>\n        <view class=\"resource-msg\"> {{ hyper_tips }} </view>\n        <view class=\"resource-operate\" v-if=\"guide == 'admit'\">\n          <view class=\"resource-now-btn\" @tap.stop=\"copy\"> 立即领取 </view>\n        </view>\n        <view class=\"resource-operate2\" v-if=\"guide == 'payment'\">\n          <view class=\"resource-cancle-btn\" @tap.stop=\"close\"> 暂时放弃 </view>\n          <view class=\"resource-now-btn\" @tap.stop=\"paymentConfirm\">\n            立即领取\n          </view>\n        </view>\n      </view>\n    </view>\n  </view>\n</template>\n\n<script>\nimport {\n  materialsList,\n  materialsEvent,\n  materialsPayment,\n  shareInvite,\n  shareInviteInfo,\n} from \"../../../api/index.js\";\nimport { errortip, isLogin, openPage } from \"../../../utils/util\";\nimport \"./index.scss\";\nexport default {\n  name: \"resource\",\n  data() {\n    return {\n      visible: false,\n      list: [],\n      loading: false,\n      pageNum: 1,\n      pageSize: 10,\n      banner: \"\",\n      guide: \"admit\",\n      hyper_tips: \"\",\n      hyper_link: \"\",\n      oid: \"\",\n      shareTitle: \"\",\n      shareImg: \"\",\n      sharePath: \"\",\n      shareFriendsTitle: \"\",\n      shareFriendsImg: \"\",\n      shareFriendsPath: \"\",\n    };\n  },\n  methods: {\n    close() {\n      this.visible = false;\n    },\n    resourceGet(oid) {\n      this.oid = oid;\n      if (isLogin()) {\n        this.materialsEvent({\n          oid: oid,\n        });\n      } else {\n        openPage(\"/pages/login/index?from=resource\");\n      }\n    },\n    copy() {\n      let _this = this;\n      wx.navigateToMiniProgram({\n        appId: \"wxdcd3d073e47d1742\",\n        path: this.hyper_link,\n        extraData: {\n          foo: \"bar\",\n        },\n        success(res) {\n          // 打开成功\n          _this.visible = false;\n        },\n      });\n    },\n    paymentConfirm() {\n      let _this = this;\n      wx.showModal({\n        title: \"支付确认\",\n        content: `领取资料需支付5金币`,\n        success: function (res) {\n          if (res.confirm) {\n            console.log(\"用户点击确定\");\n            _this.materialsPayment({\n              oid: _this.oid,\n            });\n          } else if (res.cancel) {\n            console.log(\"用户点击取消\");\n          }\n        },\n      });\n    },\n    query(type) {\n      if (type == \"init\") this.pageNum = 1;\n      this.materialsList(\n        {\n          page: this.pageNum,\n          per_page: this.pageSize,\n        },\n        type\n      );\n    },\n    // 加载更多\n    onMore() {\n      //在当前页面显示导航条加载动画\n      wx.showNavigationBarLoading();\n      //显示 loading 提示框。需主动调用 wx.hideLoading 才能关闭提示框\n      wx.showLoading({\n        title: \"数据加载中...\",\n      });\n      this.loading = false;\n      this.query(\"more\");\n    },\n    goHome() {\n      wx.switchTab({\n        url: \"/pages/home/index\",\n        success: function (e) {\n          var page = getCurrentPages().pop();\n          if (page == undefined || page == null) return;\n          // page.onLoad();\n        },\n      });\n    },\n    async materialsList(params, type) {\n      try {\n        let res = await materialsList(params);\n        //隐藏loading 提示框\n        wx.hideLoading();\n\n        //隐藏导航条加载动画\n        wx.hideNavigationBarLoading();\n        //停止下拉刷新\n        wx.stopPullDownRefresh();\n\n        if (type == \"init\") {\n          this.banner = res.data.data.items.banner;\n          this.list = res.data.data.items.list;\n          this.loading = true;\n        } else if (type == \"more\") {\n          if (!res.data.data || !res.data.data.items.list) {\n            errortip(\"没有更多数据了～\");\n            this.loading = true;\n            return false;\n          }\n          let data = res.data.data.items.list;\n          this.list = this.list.concat(data);\n          this.loading = true;\n        }\n      } catch (error) {}\n    },\n    async materialsEvent(params) {\n      try {\n        let res = await materialsEvent(params);\n        this.guide = res.data.data.guide;\n        this.hyper_tips = res.data.data.content.hyper_tips;\n        this.hyper_link = res.data.data.content.hyper_link;\n        this.visible = true;\n      } catch (error) {}\n    },\n    async materialsPayment(params) {\n      try {\n        let res = await materialsPayment(params);\n        this.hyper_link = res.data.data.content.hyper_link;\n        this.copy();\n      } catch (error) {}\n    },\n    async shareInvite(params) {\n      try {\n        let res = await shareInvite(params);\n      } catch (error) {}\n    },\n    async shareInviteInfo(params) {\n      try {\n        let res = await shareInviteInfo(params);\n        this.shareTitle = res.data.data.title;\n        this.shareImg = res.data.data.imageUrl;\n        this.sharePath = res.data.data.path;\n      } catch (error) {}\n    },\n    async shareFriendsInvite(params) {\n      try {\n        let res = await shareInvite(params);\n      } catch (error) {}\n    },\n    async shareFriendsInviteInfo(params) {\n      try {\n        let res = await shareInviteInfo(params);\n        this.shareFriendsTitle = res.data.data.title;\n        this.shareFriendsImg = res.data.data.imageUrl;\n        this.shareFriendsPath = res.data.data.path;\n      } catch (error) {}\n    },\n  },\n  mounted() {\n    this.query(\"init\");\n    this.shareInviteInfo({\n      source: \"share_details\",\n      project: \"materials\",\n    });\n    this.shareFriendsInviteInfo({\n      source: \"friends_circle\",\n      project: \"materials\",\n    });\n  },\n  onReachBottom: function () {\n    console.log(\"下拉加载更多\", this.loading);\n    this.pageNum++;\n    if (this.loading) {\n      this.onMore();\n    }\n  },\n  onShareAppMessage() {\n    this.shareInvite({\n      source: \"share_details\",\n      project: \"materials\",\n    });\n    return {\n      title: this.shareTitle,\n      imageUrl: this.shareImg,\n      path: this.sharePath, // 路径，传递参数到指定页面。\n    };\n  },\n  onShareTimeline() {\n    this.shareFriendsInvite({\n      source: \"friends_circle\",\n      project: \"materials\",\n    });\n    return {\n      title: this.shareFriendsTitle,\n      imageUrl: this.shareFriendsImg,\n      path: this.shareFriendsPath, // 路径，传递参数到指定页面。\n    };\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped></style>\n","var render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\"view\", { staticClass: \"resource\" }, [\n    _c(\"view\", { staticClass: \"resource-banner\" }, [\n      _c(\"image\", {\n        attrs: { mode: \"widthFix\", src: _vm.banner },\n        on: { tap: _vm.goHome },\n      }),\n    ]),\n    _c(\n      \"view\",\n      { staticClass: \"resource-list\" },\n      _vm._l(_vm.list, function (item, index) {\n        return _c(\"view\", { key: index, staticClass: \"resource-box\" }, [\n          item.is_hot\n            ? _c(\"image\", {\n                staticClass: \"resource-hot\",\n                attrs: {\n                  mode: \"scaleToFill\",\n                  src: \"https://yuepai-oss.qubeitech.com/static/images/hot.png\",\n                },\n              })\n            : _vm._e(),\n          _c(\"view\", { staticClass: \"resource-left\" }, [\n            _c(\"image\", { attrs: { mode: \"aspectFill\", src: item.cover } }),\n          ]),\n          _c(\"view\", { staticClass: \"resource-right\" }, [\n            _c(\"view\", { staticClass: \"resource-title\" }, [\n              _vm._v(_vm._s(item.title)),\n            ]),\n            _c(\"view\", { staticClass: \"resource-desc\" }, [\n              _vm._v(\" \" + _vm._s(item.subtitle) + \" \"),\n            ]),\n            _c(\"view\", { staticClass: \"resource-get\" }, [\n              _c(\"text\", { staticClass: \"resource-get-num\" }, [\n                _vm._v(\"已被领取：\" + _vm._s(item.click_cnt) + \"次\"),\n              ]),\n              _c(\n                \"text\",\n                {\n                  staticClass: \"resource-btn\",\n                  on: {\n                    tap: function ($event) {\n                      return _vm.resourceGet(item.oid)\n                    },\n                  },\n                },\n                [_vm._v(\"我要领取\")]\n              ),\n            ]),\n          ]),\n        ])\n      }),\n      0\n    ),\n    _vm.visible\n      ? _c(\"view\", { staticClass: \"resource-modal\", on: { tap: _vm.close } }, [\n          _c(\"view\", { staticClass: \"resource-content\" }, [\n            _c(\"view\", { staticClass: \"resource-content-title\" }, [\n              _vm._v(\" 获取资料 \"),\n            ]),\n            _c(\"view\", { staticClass: \"resource-msg\" }, [\n              _vm._v(\" \" + _vm._s(_vm.hyper_tips) + \" \"),\n            ]),\n            _vm.guide == \"admit\"\n              ? _c(\"view\", { staticClass: \"resource-operate\" }, [\n                  _c(\n                    \"view\",\n                    {\n                      staticClass: \"resource-now-btn\",\n                      on: {\n                        tap: function ($event) {\n                          $event.stopPropagation()\n                          return _vm.copy.apply(null, arguments)\n                        },\n                      },\n                    },\n                    [_vm._v(\" 立即领取 \")]\n                  ),\n                ])\n              : _vm._e(),\n            _vm.guide == \"payment\"\n              ? _c(\"view\", { staticClass: \"resource-operate2\" }, [\n                  _c(\n                    \"view\",\n                    {\n                      staticClass: \"resource-cancle-btn\",\n                      on: {\n                        tap: function ($event) {\n                          $event.stopPropagation()\n                          return _vm.close.apply(null, arguments)\n                        },\n                      },\n                    },\n                    [_vm._v(\" 暂时放弃 \")]\n                  ),\n                  _c(\n                    \"view\",\n                    {\n                      staticClass: \"resource-now-btn\",\n                      on: {\n                        tap: function ($event) {\n                          $event.stopPropagation()\n                          return _vm.paymentConfirm.apply(null, arguments)\n                        },\n                      },\n                    },\n                    [_vm._v(\" 立即领取 \")]\n                  ),\n                ])\n              : _vm._e(),\n          ]),\n        ])\n      : _vm._e(),\n  ])\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","// extracted by mini-css-extract-plugin","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"../../../../node_modules/@tarojs/taro-loader/lib/raw.js!./index.vue\"\nvar config = {\"navigationBarTitleText\":\"领取资料\",\"enablePullDownRefresh\":true};\n\n\nvar inst = Page(createPageConfig(component, 'packageActivity/pages/resource/index', {root:{cn:[]}}, config || {}))\n\n\n","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","export * from \"-!../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=template&id=45ab1bef&scoped=true&\""],"mappings":";;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC2BA;AAOA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAhBA;AAkBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AATA;AAWA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AADA;AAGA;AACA;AACA;AACA;AAZA;AAcA;AACA;AACA;AACA;AAEA;AACA;AAFA;AAMA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AANA;AAQA;AACA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAEA;AACA;AACA;AACA;AAEA;AACA;AACA;AACA;AAVA;AAAA;AAAA;AAAA;AACA;AAWA;AACA;AACA;AAdA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AACA;AAgBA;AACA;AAlBA;AACA;AADA;AAqBA;AACA;AACA;AACA;AAxBA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AA0BA;AACA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAEA;AACA;AACA;AACA;AACA;AANA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAQA;AACA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAEA;AACA;AACA;AAAA;AACA;AALA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAMA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAEA;AAFA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAEA;AACA;AACA;AACA;AALA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAEA;AAFA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAIA;AACA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAEA;AACA;AACA;AACA;AALA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAOA;AAhJA;AAkJA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AAJA;AAKA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AAJA;AAKA;AA/MA;;;;;;;;;;;;;AC1DA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACxHA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACPA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;;;;;A","sourceRoot":""}