{"version":3,"file":"pages/login/index.js","sources":["webpack:///./src/pages/login/index.vue?ad00","webpack:///index.vue","webpack:///./src/pages/login/index.vue?606c","webpack:///._src_assets_images_logo.png","webpack:///._src_pages_login_index.scss","webpack:///._src_pages_login_index.vue","webpack:///./src/pages/login/index.vue?43af","webpack:///./src/pages/login/index.vue?1ae3"],"sourcesContent":["import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=247e7dd8&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  \n}\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  \"247e7dd8\",\n  \"1c88a76c\"\n  \n)\n\ncomponent.options.__file = \"src/pages/login/index.vue\"\nexport default component.exports","<template>\n  <view>\n    <block class=\"login\" v-if=\"pageshow == 'login'\">\n      <view class=\"login-top\">\n        <image\n          src=\"../../assets/images/logo.png\"\n          mode=\"aspectFit\"\n          class=\"logo-img\"\n        ></image>\n        <view class=\"desc\">\n          <text>虾米约拍 - 严肃靠谱模特约拍平台</text>\n        </view>\n        <view class=\"small-desc\">\n          <text>MODEL PHOTOGRAPH</text>\n        </view>\n      </view>\n      <view class=\"login-bottom\">\n        <view class=\"login-btn\" @tap=\"getUserProfile\">\n          <text>微信登录</text>\n        </view>\n        <view class=\"cancel-btn\">\n          <text>取消登录</text>\n        </view>\n        <view class=\"login-tips\">\n          <text>登录即代表同意虾米约拍</text>\n          <text class=\"user-xy\">《用户协议》</text>\n        </view>\n      </view>\n    </block>\n    <block v-if=\"pageshow == 'bindphone'\" class=\"user_phone\">\n      <view class=\"user_infor\">\n        <view class=\"user_avatar\">\n          <image mode=\"widthFix\" :src=\"userInfo.avatar\"></image>\n        </view>\n        <view class=\"user_name\">{{ userInfo.nickname }}</view>\n      </view>\n      <view class=\"get_phone\">\n        <button\n          @getphonenumber=\"onGetPhoneNumber\"\n          openType=\"getPhoneNumber\"\n          class=\"phone-btn\"\n        >\n          授权绑定手机号\n        </button>\n      </view>\n    </block>\n  </view>\n</template>\n\n<script>\nimport \"./index.scss\";\nimport { wxlogin, getPhone } from \"../../api/index\";\n\nexport default {\n  name: \"login\",\n  data() {\n    return {\n      userInfo: {\n        avatar: require(\"../../assets/images/avatar_default.png\"),\n        nickname: \"xc\",\n        phone: \"\",\n      },\n      pageshow: \"login\",\n    };\n  },\n  methods: {\n    // 可以在模拟器唤起授权 获得用户信息\n    getUserProfile() {\n      let _this = this;\n      wx.getUserProfile({\n        desc: \"登录\",\n        success: (res) => {\n          this.userInfo.avatar = res.userInfo.avatarUrl;\n          this.userInfo.nickname = res.userInfo.nickName;\n          wx.login({\n            success(res) {\n              _this.getWxLogin({\n                avatar: _this.userInfo.avatar,\n                nickname: _this.userInfo.nickname,\n                account: res.code,\n                secret: \"\",\n                type: 200,\n              });\n            },\n            fail(err) {\n              console.log(err);\n            },\n          });\n        },\n        fail: (res) => {\n          console.log(res);\n        },\n      });\n    },\n    onGetPhoneNumber(e) {\n      console.log(e, \"eee\");\n      let _this = this;\n      let token = wx.getStorageSync(\"token\");\n      if (token) {\n        if (\"getPhoneNumber:ok\" == e.detail.errMsg) {\n          wx.checkSession({\n            success() {\n              //session_key 未过期，并且在本生命周期一直有效\n              //这里进行请求服务端解密手机号\n              console.log(1111);\n              _this.getPhone({});\n            },\n            fail() {\n              // session_key 已经失效，需要重新执行登录流程\n              console.log(222);\n              wx.login({\n                success(res) {\n                  _this.getWxLogin({\n                    account: res.code,\n                    avatar: res.userInfo.avatarUrl,\n                    nickname: res.userInfo.nickName,\n                    secret: \"\",\n                    type: 200,\n                  });\n                },\n                fail(err) {\n                  console.log(err);\n                },\n              });\n            },\n          });\n        }\n      } else {\n        console.log(3333);\n        this.pageshow = \"login\";\n      }\n    },\n    async getWxLogin(params) {\n      try {\n        let res = await wxlogin(params);\n        console.log(\"成功！\", res);\n        const token = res.data.data.token;\n        wx.setStorageSync(\"token\", token);\n        this.pageshow = \"bindphone\";\n      } catch (error) {\n        console.log(\"失败\");\n        // this.pageshow = \"bindphone\";\n      }\n    },\n    async getPhone(params) {\n      try {\n        let res = await getPhone(params);\n        console.log(\"成功！\", res);\n      } catch (error) {}\n    },\n  },\n  created() {\n    console.log(1111);\n    console.log(this.pageshow, \"pageshow\");\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped></style>\n","var render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"view\",\n    [\n      _vm.pageshow == \"login\"\n        ? _c(\"block\", { staticClass: \"login\" }, [\n            _c(\"view\", { staticClass: \"login-top\" }, [\n              _c(\"image\", {\n                staticClass: \"logo-img\",\n                attrs: {\n                  src: require(\"../../assets/images/logo.png\"),\n                  mode: \"aspectFit\",\n                },\n              }),\n              _c(\"view\", { staticClass: \"desc\" }, [\n                _c(\"text\", [_vm._v(\"虾米约拍 - 严肃靠谱模特约拍平台\")]),\n              ]),\n              _c(\"view\", { staticClass: \"small-desc\" }, [\n                _c(\"text\", [_vm._v(\"MODEL PHOTOGRAPH\")]),\n              ]),\n            ]),\n            _c(\"view\", { staticClass: \"login-bottom\" }, [\n              _c(\n                \"view\",\n                { staticClass: \"login-btn\", on: { tap: _vm.getUserProfile } },\n                [_c(\"text\", [_vm._v(\"微信登录\")])]\n              ),\n              _c(\"view\", { staticClass: \"cancel-btn\" }, [\n                _c(\"text\", [_vm._v(\"取消登录\")]),\n              ]),\n              _c(\"view\", { staticClass: \"login-tips\" }, [\n                _c(\"text\", [_vm._v(\"登录即代表同意虾米约拍\")]),\n                _c(\"text\", { staticClass: \"user-xy\" }, [\n                  _vm._v(\"《用户协议》\"),\n                ]),\n              ]),\n            ]),\n          ])\n        : _vm._e(),\n      _vm.pageshow == \"bindphone\"\n        ? _c(\"block\", { staticClass: \"user_phone\" }, [\n            _c(\"view\", { staticClass: \"user_infor\" }, [\n              _c(\"view\", { staticClass: \"user_avatar\" }, [\n                _c(\"image\", {\n                  attrs: { mode: \"widthFix\", src: _vm.userInfo.avatar },\n                }),\n              ]),\n              _c(\"view\", { staticClass: \"user_name\" }, [\n                _vm._v(_vm._s(_vm.userInfo.nickname)),\n              ]),\n            ]),\n            _c(\"view\", { staticClass: \"get_phone\" }, [\n              _c(\n                \"button\",\n                {\n                  staticClass: \"phone-btn\",\n                  attrs: { openType: \"getPhoneNumber\" },\n                  on: { getphonenumber: _vm.onGetPhoneNumber },\n                },\n                [_vm._v(\" 授权绑定手机号 \")]\n              ),\n            ]),\n          ])\n        : _vm._e(),\n    ],\n    1\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","module.exports = __webpack_public_path__ + \"assets/images/logo.png\";","// extracted by mini-css-extract-plugin","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"../../../node_modules/@tarojs/taro-loader/lib/raw.js!./index.vue\"\nvar config = {\"navigationBarTitleText\":\"登录\"};\n\n\nvar inst = Page(createPageConfig(component, 'pages/login/index', {root:{cn:[]}}, config || {}))\n\n\n","import mod from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","export * from \"-!../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=template&id=247e7dd8&scoped=true&\""],"mappings":";;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC4BA;AACA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAHA;AAKA;AANA;AAQA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AACA;AACA;AACA;AAZA;AAcA;AACA;AACA;AACA;AAtBA;AAwBA;AACA;AACA;AACA;AAAA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AACA;AACA;AACA;AAZA;AAcA;AAxBA;AA0BA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAEA;AACA;AACA;AACA;AACA;AANA;AAAA;AACA;AADA;AAAA;AAAA;AAQA;AACA;AATA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAWA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAEA;AACA;AAHA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAKA;AApFA;AAsFA;AACA;AACA;AACA;AArGA;;;;;;;;;;;;;ACrDA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;ACzEA;;;;;;;;;;;ACAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACPA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;;;;;A","sourceRoot":""}