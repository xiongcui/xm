{"version":3,"file":"packageMsg/pages/complaint/index.js","sources":["webpack:///./src/packageMsg/pages/complaint/index.vue?d80a","webpack:///index.vue","webpack:///./src/packageMsg/pages/complaint/index.vue?e9c6","webpack:///._src_packageMsg_pages_complaint_index.scss","webpack:///._src_packageMsg_pages_complaint_index.vue","webpack:///./src/packageMsg/pages/complaint/index.vue?4844","webpack:///./src/packageMsg/pages/complaint/index.vue?48fd"],"sourcesContent":["import { render, staticRenderFns } from \"./index.vue?vue&type=template&id=21ec3a70&scoped=true&\"\nimport script from \"./index.vue?vue&type=script&lang=js&\"\nexport * from \"./index.vue?vue&type=script&lang=js&\"\nfunction injectStyles (context) {\n  \n  \n}\n\n/* normalize component */\nimport normalizer from \"!../../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  injectStyles,\n  \"21ec3a70\",\n  \"08ffc216\"\n  \n)\n\ncomponent.options.__file = \"src/packageMsg/pages/complaint/index.vue\"\nexport default component.exports","<template>\n  <view class=\"complaint\">\n    <view class=\"complaint-title\">投诉用户</view>\n    <view class=\"complaint_top\">\n      <view class=\"complaint_top_left\">\n        <image :src=\"avatar\" class=\"avatar\"></image>\n        <view class=\"complaint_info\">\n          <view class=\"complaint_name\">\n            {{ nickname }}\n          </view>\n          <view class=\"complaint_p\">\n            <text> {{ career }} </text>\n          </view>\n        </view>\n      </view>\n    </view>\n    <view class=\"complaint_reason\">\n      <view class=\"complaint-title\">请选择投诉原因</view>\n      <view class=\"complaint-tag-box\">\n        <text\n          @tap=\"select_tag(item)\"\n          class=\"tag_item\"\n          :class=\"item.ispick ? 'tag_itemed' : ''\"\n          v-for=\"(item, index) in reasonData\"\n          :key=\"index\"\n        >\n          {{ item.value }}\n        </text>\n      </view>\n      <view class=\"complaint_input\">\n        <textarea\n          :autoHeight=\"true\"\n          class=\"intro_content\"\n          maxlength=\"500\"\n          name=\"intro\"\n          placeholder=\"请输入您的投诉内容\"\n          placeholderClass=\"intro_content_none\"\n          v-model=\"reason\"\n        ></textarea>\n      </view>\n      <view class=\"complaint_evidence\">\n        <view class=\"complaint-title\">证据截图</view>\n        <view class=\"complaint-upload-list\">\n          <view\n            class=\"complaint-upload-img\"\n            v-for=\"(item, index) in imgList\"\n            :key=\"index\"\n          >\n            <image\n              :src=\"item\"\n              class=\"upload-width\"\n              mode=\"aspectFill\"\n              @tap=\"previewImage(item, imgList)\"\n            ></image>\n            <text class=\"upload-close\" @tap=\"uploadImgClose(index)\"></text>\n          </view>\n          <view class=\"complaint-upload-img\" @tap=\"chooseImage\">\n            <image\n              src=\"../../../assets/images/upload-img.png\"\n              class=\"upload-img\"\n              mode=\"aspectFit\"\n            ></image>\n            <view>\n              <text class=\"upload-txt\">上传照片</text>\n            </view>\n          </view>\n        </view>\n      </view>\n    </view>\n    <cover-view\n      class=\"subbtn_bottom_block\"\n      :class=\"isIphoneX ? 'fix-iphonex-button' : ''\"\n    >\n      <cover-view class=\"subbtn_bottom\">\n        <button @tap=\"submit\">提交</button>\n      </cover-view>\n    </cover-view>\n  </view>\n</template>\n\n<script>\nimport \"./index.scss\";\nimport { publicConfig, publicComplain } from \"../../../api/index.js\";\nimport { errortip } from \"../../../utils/util\";\nimport { Base64 } from \"js-Base64\";\nexport default {\n  name: \"complaint\",\n  data() {\n    return {\n      isIphoneX: false,\n      visitor_id: \"\",\n      avatar: \"\",\n      nickname: \"\",\n      province_name: \"\",\n      career: \"\",\n      reason: \"\",\n      imgList: [],\n      reasonData: [],\n      uuid: \"\",\n    };\n  },\n  methods: {\n    select_tag(row) {\n      this.reasonData.map((item) => {\n        item.ispick = false;\n      });\n      row.ispick = true;\n    },\n    uploadImgClose(index) {\n      this.imgList.splice(index, 1);\n    },\n    previewImage(src, urls) {\n      // 微信预览图片的方法\n      wx.previewImage({\n        current: src, // 图片的地址url\n        urls: urls, // 预览的地址url\n      });\n    },\n    chooseImage() {\n      if (this.imgList.length >= 9) {\n        wx.showToast({\n          title: \"最多上传9张图！\",\n          icon: \"none\",\n        });\n        return false;\n      }\n      let _this = this;\n      wx.chooseMedia({\n        count: 9 - this.imgList.length,\n        mediaType: [\"image\"],\n        sourceType: [\"album\", \"camera\"],\n        maxDuration: 30,\n        camera: \"back\",\n        success(res) {\n          wx.showLoading({\n            title: \"正在上传中\",\n          });\n          let arr = res.tempFiles;\n          var imgInfo = {};\n          arr.map(function (v, i) {\n            v[\"progress\"] = 0;\n            imgInfo = v;\n            _this.upImgs(imgInfo);\n          });\n        },\n      });\n    },\n    upImgs(dataInfo) {\n      let header = {};\n      let token = wx.getStorageSync(\"token\");\n      header[\"Authorization\"] = \"Basic \" + Base64.encode(token + \":\");\n      wx.showLoading({\n        title: \"上传中\",\n        mask: true,\n      });\n      wx.uploadFile({\n        url: \"https://pai.qubeitech.com/v1/file/upload\",\n        filePath: dataInfo.tempFilePath,\n        formData: {\n          scr_type: \"complain\",\n        },\n        name: \"file\",\n        header,\n        success: (res) => {\n          wx.hideLoading();\n          //判断上传的是图片还是视频\n          let data = JSON.parse(res.data);\n          if (data.code == 200) {\n            this.imgList.push(data.data.file1);\n          } else {\n            wx.showToast({\n              title: \"上传失败！\",\n              icon: \"none\",\n            });\n          }\n        },\n      });\n    },\n    submit() {\n      let reason = this.reasonData.find((item) => {\n        return item.ispick;\n      });\n      if (!reason) {\n        errortip(\"请选择投诉原因\");\n        return false;\n      }\n      if (!this.reason) {\n        errortip(\"请输入您投诉的内容\");\n        return false;\n      }\n      let params = {\n        content: this.reason,\n        evidence: this.imgList,\n        reason: reason.value,\n        source: \"收到报名\",\n        sued_uuid: this.visitor_id,\n      };\n      this.publicComplain(params);\n      console.log(params);\n    },\n    async publicConfig(params) {\n      try {\n        let res = await publicConfig(params);\n        let arr = [];\n        arr = res.data.data.map((item, index) => {\n          item.ispick = false;\n          return item;\n        });\n        this.reasonData = arr;\n      } catch (error) {}\n    },\n    async publicComplain(params) {\n      try {\n        let res = await publicComplain(params);\n        errortip(\"投诉成功\");\n        setTimeout(() => {\n          wx.navigateBack({\n            delta: 1,\n          });\n        }, 3000);\n      } catch (error) {}\n    },\n  },\n  onLoad: function (options) {\n    this.visitor_id = options.visitor_id;\n    this.avatar = options.avatar;\n    this.nickname = options.nickname;\n    this.province_name = options.province_name;\n    this.career = options.career;\n  },\n  created() {\n    this.isIphoneX = this.globalData.isIphoneX;\n    this.publicConfig({\n      type: [\"complain_reason\"],\n    });\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped></style>\n","var render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  return _c(\n    \"view\",\n    { staticClass: \"complaint\" },\n    [\n      _c(\"view\", { staticClass: \"complaint-title\" }, [_vm._v(\"投诉用户\")]),\n      _c(\"view\", { staticClass: \"complaint_top\" }, [\n        _c(\"view\", { staticClass: \"complaint_top_left\" }, [\n          _c(\"image\", { staticClass: \"avatar\", attrs: { src: _vm.avatar } }),\n          _c(\"view\", { staticClass: \"complaint_info\" }, [\n            _c(\"view\", { staticClass: \"complaint_name\" }, [\n              _vm._v(\" \" + _vm._s(_vm.nickname) + \" \"),\n            ]),\n            _c(\"view\", { staticClass: \"complaint_p\" }, [\n              _c(\"text\", [_vm._v(\" \" + _vm._s(_vm.career) + \" \")]),\n            ]),\n          ]),\n        ]),\n      ]),\n      _c(\"view\", { staticClass: \"complaint_reason\" }, [\n        _c(\"view\", { staticClass: \"complaint-title\" }, [\n          _vm._v(\"请选择投诉原因\"),\n        ]),\n        _c(\n          \"view\",\n          { staticClass: \"complaint-tag-box\" },\n          _vm._l(_vm.reasonData, function (item, index) {\n            return _c(\n              \"text\",\n              {\n                key: index,\n                staticClass: \"tag_item\",\n                class: item.ispick ? \"tag_itemed\" : \"\",\n                on: {\n                  tap: function ($event) {\n                    return _vm.select_tag(item)\n                  },\n                },\n              },\n              [_vm._v(\" \" + _vm._s(item.value) + \" \")]\n            )\n          }),\n          0\n        ),\n        _c(\"view\", { staticClass: \"complaint_input\" }, [\n          _c(\"textarea\", {\n            directives: [\n              {\n                name: \"model\",\n                rawName: \"v-model\",\n                value: _vm.reason,\n                expression: \"reason\",\n              },\n            ],\n            staticClass: \"intro_content\",\n            attrs: {\n              autoHeight: true,\n              maxlength: \"500\",\n              name: \"intro\",\n              placeholder: \"请输入您的投诉内容\",\n              placeholderClass: \"intro_content_none\",\n            },\n            domProps: { value: _vm.reason },\n            on: {\n              input: function ($event) {\n                if ($event.target.composing) {\n                  return\n                }\n                _vm.reason = $event.target.value\n              },\n            },\n          }),\n        ]),\n        _c(\"view\", { staticClass: \"complaint_evidence\" }, [\n          _c(\"view\", { staticClass: \"complaint-title\" }, [_vm._v(\"证据截图\")]),\n          _c(\n            \"view\",\n            { staticClass: \"complaint-upload-list\" },\n            [\n              _vm._l(_vm.imgList, function (item, index) {\n                return _c(\n                  \"view\",\n                  { key: index, staticClass: \"complaint-upload-img\" },\n                  [\n                    _c(\"image\", {\n                      staticClass: \"upload-width\",\n                      attrs: { src: item, mode: \"aspectFill\" },\n                      on: {\n                        tap: function ($event) {\n                          return _vm.previewImage(item, _vm.imgList)\n                        },\n                      },\n                    }),\n                    _c(\"text\", {\n                      staticClass: \"upload-close\",\n                      on: {\n                        tap: function ($event) {\n                          return _vm.uploadImgClose(index)\n                        },\n                      },\n                    }),\n                  ]\n                )\n              }),\n              _c(\n                \"view\",\n                {\n                  staticClass: \"complaint-upload-img\",\n                  on: { tap: _vm.chooseImage },\n                },\n                [\n                  _c(\"image\", {\n                    staticClass: \"upload-img\",\n                    attrs: {\n                      src: require(\"../../../assets/images/upload-img.png\"),\n                      mode: \"aspectFit\",\n                    },\n                  }),\n                  _c(\"view\", [\n                    _c(\"text\", { staticClass: \"upload-txt\" }, [\n                      _vm._v(\"上传照片\"),\n                    ]),\n                  ]),\n                ]\n              ),\n            ],\n            2\n          ),\n        ]),\n      ]),\n      _c(\n        \"cover-view\",\n        {\n          staticClass: \"subbtn_bottom_block\",\n          class: _vm.isIphoneX ? \"fix-iphonex-button\" : \"\",\n        },\n        [\n          _c(\"cover-view\", { staticClass: \"subbtn_bottom\" }, [\n            _c(\"button\", { on: { tap: _vm.submit } }, [_vm._v(\"提交\")]),\n          ]),\n        ],\n        1\n      ),\n    ],\n    1\n  )\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","// extracted by mini-css-extract-plugin","import { createPageConfig } from '@tarojs/runtime'\nimport component from \"../../../../node_modules/@tarojs/taro-loader/lib/raw.js!./index.vue\"\nvar config = {\"navigationBarTitleText\":\"我要投诉\"};\n\n\nvar inst = Page(createPageConfig(component, 'packageMsg/pages/complaint/index', {root:{cn:[]}}, config || {}))\n\n\n","import mod from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../node_modules/babel-loader/lib/index.js!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=script&lang=js&\"","export * from \"-!../../../../node_modules/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./index.vue?vue&type=template&id=21ec3a70&scoped=true&\""],"mappings":";;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC2DA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAVA;AAYA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAHA;AAIA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AAjBA;AAmBA;AACA;AAAA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AACA;AACA;AACA;AADA;AAGA;AACA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AAFA;AAIA;AACA;AApBA;AAsBA;AACA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AAAA;AACA;AACA;AACA;AACA;AACA;AALA;AAOA;AACA;AACA;AACA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AARA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AADA;AAEA;AACA;AACA;AACA;AACA;AADA;AAGA;AARA;AAAA;AACA;AADA;AAAA;AAAA;AACA;AADA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAUA;AAxHA;AA0HA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AADA;AAGA;AAtJA;;;;;;;;;;;;;ACrFA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;ACxJA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACPA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;;;;;A","sourceRoot":""}